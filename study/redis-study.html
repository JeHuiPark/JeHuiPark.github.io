<!doctype html> <!-- Minimal Mistakes Jekyll Theme 4.12.0 by Michael Rose Copyright 2013-2018 Michael Rose - mademistakes.com | @mmistakes Free for personal and commercial use under the MIT license https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt --><html lang="ko" class="no-js"><head><meta charset="utf-8"> <!-- begin _includes/seo.html --><title>레디스 기초 공부 - JH Blog</title><meta name="description" content="developer JH website."><meta property="og:type" content="article"><meta property="og:locale" content="ko_KR"><meta property="og:site_name" content="JH Blog"><meta property="og:title" content="레디스 기초 공부"><meta property="og:url" content="https://jehuipark.github.io/study/redis-study"><meta property="og:description" content="developer JH website."><meta property="article:published_time" content="2020-08-01T18:39:29+09:00"><meta property="fb:app_id" content="150481385751381"><link rel="canonical" href="https://jehuipark.github.io/study/redis-study"> <script type="application/ld+json"> { "@context": "https://schema.org", "@type": "Person", "name": "Dev JH", "url": "https://jehuipark.github.io", "sameAs": null } </script><meta name="google-site-verification" content="googlece77ee37e1eecdba" /><meta name="naver-site-verification" content="naver4b9c5fbe228f7d5fc4264f265fee743a"> <!-- end _includes/seo.html --> <!--<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="JH Blog Feed">--><link rel="alternate" type="application/rss+xml" href="https://jehuipark.github.io/feed.xml" title="JH Blog Feed"> <!-- https://t.co/dKP3o1e --><meta name="viewport" content="width=device-width, initial-scale=1.0"> <script> document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js '; </script> <!-- For all browsers --><link rel="stylesheet" href="/assets/css/main.css"> <!--[if IE ]><style> /* old IE unsupported flexbox fixes */ .greedy-nav .site-title { padding-right: 3em; } .greedy-nav button { position: absolute; top: 0; right: 0; height: 100%; }</style><![endif]--> <script src="/assets/js/highlight.js"></script> <script src="/assets/js/highlightjs-line-numbers.min.js"></script> <!-- start custom head snippets --> <!--<link href="/assets/css/railscasts.css" rel="stylesheet" type="text/css">--><link href="/assets/css/zenburn.css" rel="stylesheet" type="text/css"> <!-- insert favicons. use https://realfavicongenerator.net/ --> <!-- end custom head snippets --><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"><link rel="icon" href="/favicon.ico" type="image/x-icon"></head><body class="layout--posts"> <!--[if lt IE 9]><div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]--><div class="masthead"><div class="masthead__inner-wrap"><div class="masthead__menu"><nav id="site-nav" class="greedy-nav"> <a class="site-title" href="/">JH Blog</a><ul class="visible-links"><li class="masthead__menu-item"> <a href="/about/" >about</a></li><li class="masthead__menu-item"> <a href="/categories" >category</a></li><li class="masthead__menu-item"> <a href="/tags" >tag</a></li></ul><button class="search__toggle" type="button"> <span class="visually-hidden">Toggle search</span> <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16"><path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path> </svg> </button> <button class="greedy-nav__toggle hidden" type="button"> <span class="visually-hidden">토글 메뉴</span><div class="navicon"></div></button><ul class="hidden-links hidden"></ul></nav></div></div></div><div class="initial-content"><div id="main" role="main"><div class="sidebar sticky"><div itemscope itemtype="https://schema.org/Person"><div class="author__avatar"> <img src="/assets/images/me.jpg" alt="JeHui Park" itemprop="image"></div><div class="author__content"><h3 class="author__name" itemprop="name">JeHui Park</h3><p class="author__bio" itemprop="description"> 개발자 박제희</p></div><div class="author__urls-wrapper"> <button class="btn btn--inverse">팔로우</button><ul class="author__urls social-icons"><li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place"> <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Seoul, Korea</span></li><li> <a href="https://jehuipark.github.io" itemprop="url"> <i class="fas fa-fw fa-link" aria-hidden="true"></i> 웹사이트 </a></li><li> <a href="mailto:pjh2359@gmail.com"><meta itemprop="email" content="pjh2359@gmail.com" /> <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> 이메일 </a></li><li> <a href="https://github.com/JeHuiPark" itemprop="sameAs" rel="nofollow noopener noreferrer"> <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub </a></li><!--<li> <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer"> <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link </a></li>--></ul></div></div></div><div class="archive"><h1 id="page-title" class="page__title">레디스 기초 공부</h1><ul id="markdown-toc"><li><a href="#레디스-주요정보-및-특징" id="markdown-toc-레디스-주요정보-및-특징">레디스 주요정보 및 특징</a></li><li><a href="#기본-명령어" id="markdown-toc-기본-명령어">기본 명령어</a><ul><li><a href="#문자열-명령" id="markdown-toc-문자열-명령">문자열 명령</a></li><li><a href="#리스트-명령" id="markdown-toc-리스트-명령">리스트 명령</a></li><li><a href="#셋-명령" id="markdown-toc-셋-명령">셋 명령</a></li><li><a href="#정렬된-셋-명령" id="markdown-toc-정렬된-셋-명령">정렬된 셋 명령</a></li><li><a href="#해시-명령" id="markdown-toc-해시-명령">해시 명령</a></li></ul></li><li><a href="#데이터-처리-명령어" id="markdown-toc-데이터-처리-명령어">데이터 처리 명령어</a><ul><li><a href="#접두사와-접미사" id="markdown-toc-접두사와-접미사">접두사와 접미사</a></li><li><a href="#문자열" id="markdown-toc-문자열">문자열</a></li><li><a href="#해시-데이터" id="markdown-toc-해시-데이터">해시 데이터</a></li><li><a href="#셋-데이터" id="markdown-toc-셋-데이터">셋 데이터</a></li><li><a href="#정렬된-셋-데이터" id="markdown-toc-정렬된-셋-데이터">정렬된 셋 데이터</a></li><li><a href="#리스트-데이터" id="markdown-toc-리스트-데이터">리스트 데이터</a></li></ul></li><li><a href="#키-제어-명령어" id="markdown-toc-키-제어-명령어">키 제어 명령어</a></li><li><a href="#레디스-프로토콜" id="markdown-toc-레디스-프로토콜">레디스 프로토콜</a></li><li><a href="#클러스터" id="markdown-toc-클러스터">클러스터</a><ul><li><a href="#복제" id="markdown-toc-복제">복제</a></li><li><a href="#샤딩" id="markdown-toc-샤딩">샤딩</a></li></ul></li><li><a href="#레디스-운영-시-고려사항" id="markdown-toc-레디스-운영-시-고려사항">레디스 운영 시 고려사항</a></li><li><a href="#기타" id="markdown-toc-기타">기타</a></li><li><a href="#참고자료" id="markdown-toc-참고자료">참고자료</a></li></ul><h2 id="레디스-주요정보-및-특징">레디스 주요정보 및 특징</h2><ul><li>영속성을 지원하는 인메모리 데이터 저장소</li><li>읽기 성능 증대를 위한 서버 측 복제를 지원</li><li>쓰기 성능 증대를 위한 클라이언트 측 샤딩을 지원</li><li>5가지 데이터형 (문자열, 리스트, 해시, 셋, 정렬된 셋) 을 지원</li><li>메모리 이외의 영구 저장소를 지원하므로 인스턴스 재시작에 대한 캐시 웜업에 대한 고려가 필요하지 않음</li></ul><h2 id="기본-명령어">기본 명령어</h2><h3 id="문자열-명령">문자열 명령</h3><ul><li>레디스의 증감처리는 signed integer 로 표현할 수 있는 범위에서만 가능하다(시스템 종속적인 정수형을 가지지 않는다)<br /> 표현범위를 넘어설 경우 overflow 오류 발생</li><li>문자열 데이터의 최대 크기는 <code class="highlighter-rouge">512MB</code></li></ul><table><thead><tr><th>커맨드</th><th>응답</th><th>지원버전</th><th>시간복잡도</th><th>설명</th></tr></thead><tbody><tr><td>set</td><td>OK</td><td>1</td><td>O(1)</td><td>주어진 키에 값을 저장한다</td></tr><tr><td>append</td><td>문자열의 전체 길이</td><td>2</td><td>O(1)</td><td>키가 존재하면 append, 아니면 set 과 동일</td></tr><tr><td>incr</td><td>결과값(value)을 리턴</td><td>1</td><td>O(1)</td><td>증가연산 (1씩, 숫자만 해당)</td></tr><tr><td>decr</td><td>결과값(value)을 리턴</td><td>1</td><td>O(1)</td><td>감소연산 (1씩, 숫자만 해당)</td></tr></tbody></table><h3 id="리스트-명령">리스트 명령</h3><ul><li>리스트 데이터는 논리적으로 링크드 리스트의 구현이다 (이중 연결 리스트)</li><li>데이터가 입력된 순서대로 저장되고 조회된다는 특징 때문에 먼저 입력한 자료를 먼저 처리하는 큐로 사용되기도 한다</li></ul><table><thead><tr><th>커맨드</th><th>응답</th><th>지원버전</th><th>시간복잡도</th><th>설명</th></tr></thead><tbody><tr><td>lpush</td><td>명령이 수행된 후 리스트 사이즈</td><td>1</td><td>O(1)</td><td>맨 앞쪽에 입력된 요소를 저장한다</td></tr><tr><td>lrange</td><td>해당 범위의 요소들, 존재하지 않으면 nil</td><td>O(S+N)</td><td>1</td><td>리스트의 시작 인덱스 부터 종료 인덱스 범위의 요소를 조회한다 (<a href="#negative-index-sample">예시</a>)</td></tr></tbody></table><h3 id="셋-명령">셋 명령</h3><table><thead><tr><th>커맨드</th><th>응답</th><th>지원버전</th><th>시간복잡도</th><th>설명</th></tr></thead><tbody><tr><td>sadd</td><td>성공이면 입력된 값의 개수, 이미 존재하면 0</td><td>1</td><td>O(N) N은 입력된 값의 개수</td><td>지정된 셋에 입력된 값을 저장한다.</td></tr><tr><td>smembers</td><td>조회된 값 목록, 존재하지 않으면 nil</td><td>1</td><td>O(N) N은 입력된 값의 개수</td><td>지정된 셋에 저장된 모든 값의 목록을 조회한다.</td></tr></tbody></table><h3 id="정렬된-셋-명령">정렬된 셋 명령</h3><p>저장된 요소에 가중치를 부여하여 ASC 정렬을 제공한다.<br /> 가중치가 동일할 경우에는 정렬 안정성을 보장하지 않는다.</p><table><thead><tr><th>커맨드</th><th>응답</th><th>지원버전</th><th>시간복잡도</th><th>설명</th></tr></thead><tbody><tr><td>zadd</td><td>성공이면 입력된 값의 개수, 이미 존재하면 0</td><td>1.2</td><td>O(log(N))</td><td>정렬된 셋에 가중치와 값으로 우리우전 데이터를 저장한다. 단, 이미 존재하는 값이면 기존의 가중치를 입력된 가중치로 덮어쓴다</td></tr><tr><td>zrange</td><td>조회된 값 목록, 값이 존재하지 않으면 nil</td><td>1.2</td><td>O(log(N)+M) N은 입력되어 있는 값의 개수, M은 조회된 값으 개수</td><td>정렬된 셋의 시작 인덱스부터 종료 인덱스 범위에 해당하는 값들을 가중치 오름차순으로 조회한다.</td></tr></tbody></table><h3 id="해시-명령">해시 명령</h3><table><thead><tr><th>커맨드</th><th>응답</th><th>지원버전</th><th>시간복잡도</th><th>설명</th></tr></thead><tbody><tr><td>hset</td><td>존재하지 않는 필드일 때 1, 존재하는 필드일 때 0</td><td>2</td><td>O(1)</td><td>지정된 해시에 요청한 필드와 값을 저장한다</td></tr><tr><td>hget</td><td>지정된 필드가 존재할 때 저장된 값, 아니면 nil</td><td>2</td><td>O(1)</td><td>지정된 해시에 저장된 필드의 값을 조회한다.</td></tr><tr><td>hgetall</td><td>지정된 키에 저장된 모든 필드와 값의 목록</td><td>2</td><td>O(N)</td><td>지정된 키에 저장된 모든 필드와 값을 조회한다.</td></tr></tbody></table><h2 id="데이터-처리-명령어">데이터 처리 명령어</h2><h3 id="접두사와-접미사">접두사와 접미사</h3><p>레디스는 기본적인 명령에 접두사와 접미사를 조합한 명령어를 제공한다. (몇 가지 예외 사항은 존재)</p><table><thead><tr><th>접두사 커맨드</th><th>설명</th></tr></thead><tbody><tr><td>m</td><td>멀티</td></tr><tr><td>s</td><td>멀티</td></tr><tr><td>z</td><td>정렬된 셋</td></tr><tr><td>h</td><td>해시 데이터</td></tr></tbody></table><table><thead><tr><th>접미사 커맨드</th><th>설명</th></tr></thead><tbody><tr><td>nx</td><td>값이 없을 경우에만 처리 (<strong>원자성 보장</strong>)</td></tr><tr><td>by</td><td>주어진 값만큼 증가/감소 처리 (<code class="highlighter-rouge">incr</code>, <code class="highlighter-rouge">decr</code> 커맨드와 조합하여 사용, 값의 부호에 영향을 받으며 수학적 개념과 동일)</td></tr></tbody></table><h3 id="문자열">문자열</h3><p>레디스는 비트연산을 통해 저장되는 문자열 데이터를 비트 단위로 처리할 수 있다.<br /> 레디스는 데이터의 저장을 바이트 단위로 하기 때문에 키가 존재하지 않을 때, <code class="highlighter-rouge">setbit</code> 의 실행 결과로 생성되는 데이터의 크기는 <code class="highlighter-rouge">(오프셋/8) + 1</code> 이다</p><table><thead><tr><th>커맨드</th><th>응답</th><th>지원버전</th><th>시간복잡도</th><th>설명</th></tr></thead><tbody><tr><td>getset</td><td>이전에 저장된 값을 리턴</td><td>1</td><td>O(1)</td><td>입력된 값을 저장하고, 저장되어 있던 값을 리턴한다. 없으면 <code class="highlighter-rouge">nil</code> 리턴</td></tr><tr><td>setbit</td><td>이전에 저장된 비트의 값</td><td>2.2</td><td>O(1)</td><td>입력된 오프셋 위치에 저장된 bit 값을 변경한다</td></tr><tr><td>getbit</td><td>비트</td><td>2.2</td><td>O(1)</td><td>입력된 오프셋 위치에 저장된 bit 값을 리턴한다</td></tr><tr><td>bitcount</td><td>지정된 범위에 저장된 비트 중 1의 개수</td><td>2.6</td><td>O(N)</td><td>주어진 키값의 비트 중 1인 값의 개수를 조회한다. 인덱스 범위는 바이트 단위 인덱스다.</td></tr></tbody></table><h3 id="해시-데이터">해시 데이터</h3><ul><li>해시 데이터는 2<sup>32</sup>-1개의 필드와 값을 저장할 수 있다 (약 42억)</li><li>경험적으로 이해할 수 있는 명령어라 명령어 표는 생략 <code class="highlighter-rouge">hmset</code>, <code class="highlighter-rouge">hsetnx</code>, <code class="highlighter-rouge">hmget</code>, <code class="highlighter-rouge">hlen</code>, <code class="highlighter-rouge">hdel</code>, <code class="highlighter-rouge">hkeys</code>, <code class="highlighter-rouge">hvals</code>, <code class="highlighter-rouge">hincrby</code>, <code class="highlighter-rouge">hincrbyfloat</code></li><li>해시에 저장된 데이터의 필드값이 숫자일 때 증감연산을 이용할 수 있다 (소수점은 17자리로 고정)</li></ul><p><a href="#redis-zipmap">해시 데이터의 특별한 유형</a></p><h3 id="셋-데이터">셋 데이터</h3><ul><li>셋 데이터는 2<sup>32</sup>-1개의 필드와 값을 저장할 수 있다 (약 42억)</li><li>셋의 특성상 값이 저장될 때 중복에 대한 확인 작업을 수행하기 때문에 nx 접미사 명령은 존재하지 않는다</li><li>집합 연산을 지원한다 (합집합, 교집합, 차집합)</li></ul><table><thead><tr><th>커맨드</th><th>응답</th><th>지원버전</th><th>시간복잡도</th><th>설명</th></tr></thead><tbody><tr><td>sinter</td><td>교집합에 해당하는 값</td><td>1</td><td>O(N)</td><td>주어진 키에 저장된 요소들의 교집합을 돌려준다</td></tr><tr><td>scard</td><td>저장된 요소의 개수</td><td>1</td><td>O(1)</td><td>주어진 키에 저장된 요소들의 개수를 리턴한다 (card 는 cardinality 의 약자</td></tr><tr><td>srem</td><td>제거된 값의 수</td><td>1</td><td>O(1)</td><td>주어진 키에 저장된 요소를 제거하고 제거된 요소의 개수를 리턴한다</td></tr><tr><td>spop</td><td>제거된 값</td><td>1</td><td>O(1)</td><td>주어진 키에 저장된 요소 중에서 임의의 요소를 제거하고 리턴한다</td></tr><tr><td>sismember</td><td>존재하면 1, 존재하지 않으면 0</td><td>1</td><td>O(1)</td><td>입력된 요소가 주어진 키에 저장되어 있는지에 대한 여부를 리턴한다.</td></tr><tr><td>smove</td><td>이동되었으면 1, 실패하면 0</td><td>1</td><td>O(1)</td><td>원본키에 저장된 요소를 대상키로 이동하고 이동 결과를 리턴한다. 원본키가 존재하지 않으면 결과로 0을 리턴하고, 대상 키가 존재하지 않으면 새로운 셋 데이터를 생성하고 요소를 이동시킨다</td></tr></tbody></table><h3 id="정렬된-셋-데이터">정렬된 셋 데이터</h3><ul><li>z와 명령어 가운데에 <code class="highlighter-rouge">rev</code> 라는 접두사가 추가되면 내림차순 정렬을 의미한다<br /> zrevrange 명령은 내림차순으로 정렬된 결과를 리턴한다</li><li>저장 가능한 요소의 수는 셋 데이터와 동일하다</li><li>LIMIT 키워드를 이용하여 일부의 데이터만 조회하는 것이 가능하다 MySQL 의 LIMIT 과 유사 (다른 명령어와의 조합도 가능할 것 같은데? 더 공부해봐야겠음)</li><li>정렬된 셋의 명령 중에서 가중치의 범위를 인자로 사용하는 명령은 특별한 표현식을 포함하여 사용할 수 있다<ul><li>무한대 표현식 <code class="highlighter-rouge">+inf</code>, <code class="highlighter-rouge">-inf</code></li><li>초과/미만 표현식 <code class="highlighter-rouge">zrangebyscore ex-key (1 (3</code> (ex-key 키에 저장된 요소중에 가중치가 1보다 크고 3보다 작은 범위에 해당하는 요소를 조회한다)</li></ul></li></ul><table><thead><tr><th>커맨드</th><th>응답</th><th>지원버전</th><th>시간복잡도</th><th>설명</th></tr></thead><tbody><tr><td>zincrby</td><td>적용된 가중치 값</td><td>1.2</td><td>O(log(N))</td><td>주어진 키에 저장된 셋 데이터 중 지정된 요소의 가중치를 입력된 값만큼 증가 시킨다</td></tr><tr><td>zrank</td><td>값이 존재하면 가중치 오름차순으로 정렬된 순위, 없으면 nil</td><td>2</td><td>O(log(N))</td><td>주어진 키에 저장된 셋 데이터 중 지정된 요소의 순위를 조회한다. (zero base)</td></tr><tr><td>zrevrank</td><td>값이 존재하면 내림차순 순위, 없으면 nil</td><td>2</td><td>O(log(N))</td><td>주어진 키에 저장된 셋 데이터 중 지정된 요소의 순위를 조회한다. (zero base)</td></tr><tr><td>zrangebyscore</td><td>-</td><td>-</td><td>-</td><td>정렬된 셋의 점수 범위에 해당하는 데이터 조회</td></tr><tr><td>zremrangebyrank</td><td>-</td><td>-</td><td>-</td><td>정렬된 셋에서 순위에 해당하는 범위의 데이터 제거</td></tr><tr><td>zremrangebyscore</td><td>-</td><td>-</td><td>-</td><td>정렬된 셋에서 가중치에 해당하는 범위의 데이터 제거</td></tr></tbody></table><h3 id="리스트-데이터">리스트 데이터</h3><ul><li>저장 가능한 요소의 수는 셋 데이터와 동일하다</li><li>이중 연결 리스트로 구현되어 있기 때문에 첫 번째 요소와 마지막 요소이 조회 시간이 가장 빠르며 리스트의 중간에 저장된 데이터를 조회하는 시간이 가장 오래 걸린다</li></ul><table><thead><tr><th>커맨드</th><th>응답</th><th>지원버전</th><th>시간복잡도</th><th>설명</th></tr></thead><tbody><tr><td>lindex</td><td>해당 인덱스 위치에 저장된 요소</td><td>1</td><td>O(N)</td><td>지정된 리스트에 저장된 요소의 인덱스에 해당하는 요소의 값을 조회한다</td></tr><tr><td>blpop</td><td>조회된 요소</td><td>2</td><td>O(1)</td><td>지정된 리스트에 저장된 요소 중 맨 왼쪽 요소를 조회한다. 단 저장된 데이터가 없거나 키가 존재하지 않을 때는 만료시간에 지정된 시간만큼 대기한다 (단위:초). 0이면 무한히 대기)</td></tr><tr><td>brpop</td><td>조회된 요소</td><td>2</td><td>O(1)</td><td>지정된 리스트에 저장된 요소 중 맨 오른쪽 요소를 조회한다. 단 저장된 데이터가 없거나 키가 존재하지 않을 때는 만료시간에 지정된 시간만큼 대기한다 (단위:초). 0이면 무한히 대기)</td></tr></tbody></table><h2 id="키-제어-명령어">키 제어 명령어</h2><h2 id="레디스-프로토콜">레디스 프로토콜</h2><h2 id="클러스터">클러스터</h2><h3 id="복제">복제</h3><p>프라이머리 노드(쓰기 전용)와 세컨더리 노드(읽기 전용)를 구성하여 트래픽을 분산하는 기법</p><ul><li>세컨더리 노드는 언제든지 확장이 가능하다 (데이터 복제 요청을 세컨더리 노드가 프라이머리 노드에게 요청하기 때문에 프라이머리 노드의 무중단이 보장됨)<br /> 단, 세컨더리 노드가 처음 올라올 때 프라이머리 노드의 모든 데이터를 복제해야 하는데 이때 최대한의 리소스를 사용하기 때문에 복제하는 동안에 프라이머리 노드의 성능이 저하될 수 있다.</li><li>프라이머리 노드에 쓰기 작업이 발생하면 세컨더리 노드에 변경 이벤트를 전파하여 데이터 일관성을 유지한다.</li><li>노드를 복제 한다고 해서 성능이 선형으로 증가하지는 않는다 (데이터 대역폭, 네트워크 대역폭, 데이터 동기화 작업) 이를 임계점이라고 함</li><li>레디스 클라이언트에서 쓰기/읽기 노드를 모두 알고 있어야 한다</li></ul><h3 id="샤딩">샤딩</h3><p>데이터를 특정 조건에 따라 나누어 저장<br /> 레디스 2.6 버전은 서버측 샤딩을 지원하지 않기 때문에 위치 투명성이 보장되지 않는다. (클라이언트측 샤딩 기법을 이용해야 함)</p><ul><li>수직 샤딩 (Vertical Sharding) 데이터 성격에 따라 분리</li><li>범위 샤딩 (Range Sharding) 데이터의 범위에 따라 분리</li><li>해시 기반 샤딩 (Hash Based Sharding) 키값을 해싱하고 해싱된 값을 이용하여 저장소를 선택하는 방법으로 일관된 해싱(Consistent Hashing)이라고 부르기도 함</li></ul><h2 id="레디스-운영-시-고려사항">레디스 운영 시 고려사항</h2><p>레디스는 데이터 저장과 조회에 단일 스레드를 사용한다 (하나의 CPU 코어만 이용), 그렇기 때문에 멀티코어는 레디스 성능에 큰 영향을 주지 않는다.</p><ul><li>CPU 임계점</li><li>메모리 대역폭</li><li>네트워크 대역폭</li></ul><p>Q. 만약 레디스에 저장될 데이터의 크기를 산정하지 못하여 레디스 설정에서 <code class="highlighter-rouge">maxmemory</code> 값을 지정하지 못했다면?<br /> A. 레디스에 데이터가 계속 추가되어 물리 메모리가 부족하게 되면 스왑 메모리를 이용하게 되며 스왑 메모리에 데이터가 저장되기 시작하면 성능이 저하된다<br /> 스왑 메모리 공간이 부족해지면 OOM 킬러가 동작한다</p><p>레디스가 <code class="highlighter-rouge">AOF</code>나 스냅샷과 같은 영구 저장소를 사용하도록 설정되어 있다면 스왑영역은 최소한 물리 메모리 크기만큼의 스왑영역을 설정해야 한다.</p><blockquote><p>레디스에서 스냅샷을 위한 <code class="highlighter-rouge">fork</code> 함수가 동작하면 레디스가 점유하는 메모리만큼의 메모리를 다시 할당하려고 시도하게 된다.</p></blockquote><p>레디스 복제 구성에서는 프라이머리 노드의 스냅샷 설정이 꺼져 있더라도, 새로운 세컨더리 노드가 프라이머리 노드에 추가되면 프라이머리 노드는 전체 데이터를 복제하기 위해 스냅샷을 생성한다.<br /> 레디스는 복제를 위해서 스냅샷을 생성하고 스냅샷 데이터를 세컨더리 노드로 전송하기 위한 버퍼를 생성하는데, 이 버퍼의 크기가 지정된 크기보다 커지면 세컨더리 노드의 연결을 강제로 끊게 된다.</p><blockquote><p>관련설정 <code class="highlighter-rouge">client-output-buffer-limit</code></p></blockquote><h2 id="기타">기타</h2><ul><li>레디스의 키 이름에는 제한이 없으며 어떤 문자도 사용할 수 있다 (관례상 콜론은 키에 의미를 부여하는 구분자로 사용된다.)</li><li>응답값을 가지는 레디스 명령은 상태응답, 에러응답, 숫자응답, 단일 벌크응답, 멀티 벌크응답으로 나</li><li>레디스 명령의 인덱스 표현에서 <code class="highlighter-rouge">-1</code> 은 조금 특별하다 (음수가 입력되면 인덱스를 맨 마지막부터 센다.)<br /> <span id="negative-index-sample">예시</span>)<blockquote><p><code class="highlighter-rouge">lrange key 0 -2</code> (키의 이름이 <code class="highlighter-rouge">key</code>인 리스트의 0번째부터 마지막에서 두번째까지의 데이터를 조회하라)</p></blockquote></li><li>CAP 정리<br /> 일관성(Consistency), 가용성(Availability), 분할 허용성(Partition Tolerance) 모두를 동시에 지원하는 분산 컴퓨터 시스템은 없다</li><li>레디스는 정전과 같은 하드웨어 장애 발생 시에 데이터 유실을 방지하기 위하여 AOF(Append Only File) 를 사용한다.</li><li>https://blog.nahurst.com/visual-guide-to-nosql-systems</li><li><span id="redis-zipmap">해시 데이터의 특별한 유형</span> 레디스는 메모리 공간을 절약하기 위해서 세 가지 내부 저장구조(zipmap, ziplist, intset)를 사용한다.<br /> 이 내부 저장구조를 사용하게 되면 CPU를 더 사용하게 된다.</li></ul><h2 id="참고자료">참고자료</h2><ul><li>이것이 레디스다 (저자: 정경석 출판사: 한빛 미디어)</li></ul><a href="#page-title" class="back-to-top">Back to Top &uarr;</a><div class="page__comments"><h4 class="page__comments-title">댓글남기기</h4><section id="disqus_thread"></section></div><script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML'></script></div></div></div><div class="search-content"><div class="search-content__inner-wrap"><input type="text" id="search" class="search-input" tabindex="-1" placeholder="검색어를 입력해주세요..." /><div id="results" class="results"></div><h3>우측 상단의 돋보기를 누르면 원래 화면으로 돌아갈 수 있습니다.</h3></div></div><div class="page__footer"><footer> <!-- start custom footer snippets --> <!-- end custom footer snippets --><div class="page__footer-follow"><ul class="social-icons"><li><strong>팔로우:</strong></li><li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> 피드</a></li></ul></div><div class="page__footer-copyright">&copy; 2022 Dev JH. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div></footer></div><script src="/assets/js/main.min.js"></script> <script defer src="https://use.fontawesome.com/releases/v5.6.0/js/all.js" integrity="sha384-z9ZOvGHHo21RqN5De4rfJMoAxYpaVoiYhuJXPyVmSs8yn20IE3PmBM534CffwSJI" crossorigin="anonymous"></script> <script src="/assets/js/lunr/lunr.min.js"></script> <script src="/assets/js/lunr/lunr-store.js"></script> <script src="/assets/js/lunr/lunr-en.js"></script> <!-- start custom analytics snippet --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-113477172-1', 'auto'); ga('send', 'pageview'); </script> <!-- end custom analytics snippet --> <script> var disqus_config = function () { this.page.url = "https://jehuipark.github.io/study/redis-study"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/study/redis-study"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function() { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://https-jehuipark-github-io-blog.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> <script> $(document).ready(function() { $('pre code').each(function(i, block) { try{block.className = block.parentElement.parentElement.parentElement.className.split(' ')[0].replace('language-', '')}catch(e){}; hljs.highlightBlock(block); }); hljs.initLineNumbersOnLoad(); }); </script></body></html>